#!/usr/bin/env ruby
#
# frozen_string_literal: true

require 'bundler/setup'
require 'optparse'

require_relative '../lib/builder'
require_relative '../lib/server'
require_relative '../lib/hot_reload'

port = 8000

OptionParser.new do |opts|
  opts.banner = "Usage: bin/dev [options]"

  opts.on('-p', '--port PORT', 'Specify the port to run the server on (default: 8000)') do |p|
    port = p.to_i
  end

  opts.on('-h', '--help', 'Display this help message') do
    puts opts
    exit
  end
end.parse!

SSG::HotReload.start

SSG::Builder.prepare_output_dir
SSG::Builder.build

SSG::Server.new(port).start
